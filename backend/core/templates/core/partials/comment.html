<div class="comment-item"
     data-comment-id="{{ c.id }}"
     data-post-id="{{ c.post.id }}"
     style="margin-left: {{ level }}px;">

    <!-- HEADER -->
    <div class="comment-header">
        <div class="comment-avatar">
            {{ c.author.display_name|default:c.author.username|first|upper }}
        </div>

        <div class="comment-author-line">
            <b style="color:#e5e7eb;">
                {{ c.author.display_name|default:c.author.username }}
            </b>
            <span style="color:#9ca3af;">@{{ c.author.username }}</span>
            <span style="color:#6b7280;font-size:11px;">
                {{ c.created_at|date:"d.m.Y H:i" }}
            </span>
        </div>
    </div>

    <!-- –¢–ï–ö–°–¢ -->
    <div class="comment-text">{{ c.text }}</div>

    <!-- FOOTER -->
    <div style="display:flex;gap:10px;margin-top:3px;align-items:center;flex-wrap:wrap;">

        {# –ª–∞–π–∫ –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π #}
        {% if user.is_authenticated %}
            <form method="post"
                  action="{% url 'toggle_comment_like' c.id %}"
                  class="comment-like-form"
                  data-comment-id="{{ c.id }}">
                {% csrf_token %}
                <button class="comment-like-button"
                        type="submit"
                        style="background:none;border:none;font-size:15px;cursor:pointer;"
                        data-liked="{% if c.id in liked_comment_ids %}true{% else %}false{% endif %}">
                    {% if c.id in liked_comment_ids %}‚ù§Ô∏è{% else %}ü§ç{% endif %}
                </button>
            </form>
        {% endif %}

        <span class="comment-like-count"
              data-comment-id="{{ c.id }}"
              style="font-size:12px;color:#9ca3af;">
            {{ c.likes.count }} –ª–∞–π–∫–æ–≤
        </span>

        {% if user.is_authenticated %}
            {# –∫–Ω–æ–ø–∫–∞ "–û—Ç–≤–µ—Ç–∏—Ç—å" ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç/—Å–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É –≤–≤–æ–¥–∞ –æ—Ç–≤–µ—Ç–∞ #}
            <button class="comment-reply-toggle"
                    type="button"
                    data-comment-id="{{ c.id }}"
                    style="background:none;border:none;color:#93c5fd;font-size:12px;cursor:pointer;">
                –û—Ç–≤–µ—Ç–∏—Ç—å
            </button>

            {# –ö–Ω–æ–ø–∫–∞ "–û—Ç–≤–µ—Ç—ã (N)" ‚Äî —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç/—Å–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ—Ç–≤–µ—Ç–æ–≤ #}
            {% with replies=c.replies.all %}
                {% if replies %}
                    <button class="replies-toggle"
                            type="button"
                            data-comment-id="{{ c.id }}"
                            style="background:none;border:none;color:#9ca3af;font-size:12px;cursor:pointer;">
                        –û—Ç–≤–µ—Ç—ã ({{ replies|length }})
                    </button>
                {% endif %}
            {% endwith %}

            {# –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (AJAX, –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏) #}
            {% if user == c.author or user.is_superuser %}
                <form method="post"
                      action="{% url 'delete_comment' c.id %}"
                      class="comment-delete-form"
                      data-comment-id="{{ c.id }}"
                      data-post-id="{{ c.post.id }}">
                    {% csrf_token %}
                    <button type="submit"
                            style="background:none;border:none;color:#fca5a5;font-size:12px;cursor:pointer;">
                        –£–¥–∞–ª–∏—Ç—å
                    </button>
                </form>
            {% endif %}
        {% endif %}
    </div>

    <!-- –§–û–†–ú–ê –û–¢–í–ï–¢–ê (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    {% if user.is_authenticated %}
        <form method="post"
              action="{% url 'add_reply' c.id %}"
              class="reply-form hidden"
              data-parent-id="{{ c.id }}"
              data-post-id="{{ c.post.id }}"
              style="margin-left:10px;">
            {% csrf_token %}
            <textarea name="text"
                      class="reply-input"
                      placeholder="–û—Ç–≤–µ—Ç–∏—Ç—å..."
                      required></textarea>
            <button type="submit" class="reply-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </form>
    {% endif %}

    {# –í–õ–û–ñ–ï–ù–ù–´–ï –û–¢–í–ï–¢–´ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç—ã –∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ –∫–Ω–æ–ø–∫–µ "–û—Ç–≤–µ—Ç—ã" #}
    {% with replies=c.replies.all %}
        {% if replies %}
            <div class="replies-block hidden" data-parent-id="{{ c.id }}">
                {% for r in replies %}
                    {% include "core/partials/comment.html" with c=r user=user liked_comment_ids=liked_comment_ids level=level|add:20 %}
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

</div>
